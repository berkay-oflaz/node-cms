{"version":3,"sources":["webpack:///webpack/bootstrap af96a3497a77e16c75db","webpack:///external \"mongoose\"","webpack:///./server/models/message.js","webpack:///./server/controllers/PostController.js","webpack:///./server/models/user.js","webpack:///external \"express\"","webpack:///external \"passport\"","webpack:///./server/controllers/UserController.js","webpack:///./server/models/post.js","webpack:///./server/config/database.js","webpack:///external \"fs\"","webpack:///./server/config/passport.js","webpack:///./server/routes/admin.routes.js","webpack:///./server/routes/auth.routes.js","webpack:///./server/routes/public.routes.js","webpack:///external \"body-parser\"","webpack:///external \"connect-mongo\"","webpack:///external \"cookie-parser\"","webpack:///external \"cors\"","webpack:///external \"dotenv\"","webpack:///external \"errorhandler\"","webpack:///external \"express-flash\"","webpack:///external \"express-session\"","webpack:///external \"express-validator\"","webpack:///external \"http\"","webpack:///external \"https\"","webpack:///external \"method-override\"","webpack:///external \"morgan\"","webpack:///external \"multer\"","webpack:///external \"node-uuid\"","webpack:///external \"nunjucks\"","webpack:///external \"path\"","webpack:///external \"socket.io\"","webpack:///external \"universal-analytics\"","webpack:///./server/config/auth.js","webpack:///./server/controllers/ChatController.js","webpack:///./server/main.js","webpack:///./server/models/conversation.js","webpack:///external \"bcrypt-nodejs\"","webpack:///external \"crypto\"","webpack:///external \"mongoose-slug-hero\"","webpack:///external \"passport-google-oauth\"","webpack:///external \"passport-local\""],"names":["mongoose","require","Schema","MessageSchema","conversationId","type","Types","ObjectId","required","body","String","author","ref","timestamps","module","exports","model","Post","PostController","req","res","id","params","sendStatus","find","public","err","data","status","json","success","title","content","msg","PostData","update","_id","console","log","findOne","post","editor","postEntry","save","query","sort","exec","results","postKey","substr","bcrypt","crypto","userSchema","name","password","email","lowercase","unique","role","enum","default","google","token","isActive","Boolean","image","pre","next","user","isModified","genSalt","salt","hash","methods","comparePassword","candidatePassword","cb","compare","isMatch","User","passport","create","assert","isEmail","len","equals","sanitize","normalizeEmail","remove_dots","errors","validationErrors","flash","existingUser","logIn","postLogin","notEmpty","authenticate","info","auth","isAuthenticated","render","postLogout","logout","session","authenticated","GetUsersList","slugHero","PostSchema","createdBy","updatedBy","plugin","field","LocalStrategy","Strategy","GoogleStrategy","OAuth2Strategy","config","configAuth","serializeUser","done","deserializeUser","findById","use","usernameField","passReqToCallback","toLowerCase","clientID","googleAuth","clientSecret","callbackURL","refreshToken","profile","process","nextTick","newUser","displayName","emails","value","authentication","isAuthorized","provider","path","split","slice","tokens","kind","express","MessageModel","fs","controllers","ChatController","UserController","API_AUTHENTICATION","admin","Router","get","send","getConversations","getConversation","sendReply","newConversation","listAll","getPostBySlug","put","scope","successRedirect","failureRedirect","PublicRoute","posts","slug","result","$inc","read","nbRows","raw","Conversation","Message","participants","select","conversations","error","fullConversations","forEach","conversation","limit","populate","message","push","length","messages","recipient","composedMessage","newMessage","reply","sentReply","deleteConversation","findOneAndRemove","$and","bodyParser","morgan","http","https","nunjucks","app","MongoStore","cookieParser","dotenv","expressValidator","PORT","env","methodOverride","cors","errorHandler","multer","server","createServer","io","ua","visitor","pageview","root","cwd","load","passportConfig","UserModel","uuid","on","client","sockets","emit","Object","keys","connected","locals","url","protocol","set","join","configure","autoescape","noCache","watch","urlencoded","extended","static","SESSION_SECRET","resave","saveUninitialized","secret","store","mongooseConnection","connection","ttl","rolling","cookie","httpOnly","ephemeral","maxAge","initialize","connect","MONGODB_URI","MONGOLAB_URI","Promise","chalk","red","exit","sendFile","listen","ConversationSchema"],"mappings":"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","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 35);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap af96a3497a77e16c75db","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","var mongoose = require('mongoose');\nvar Schema = mongoose.Schema;\n// var bcrypt = require('bcrypt');\n\nvar MessageSchema = new Schema({\n    conversationId: {\n        type: Schema.Types.ObjectId,\n        required: true\n    },\n    body: {\n        type: String,\n        required: true\n    },\n    author: {\n        type: Schema.Types.ObjectId,\n        ref: 'User'\n    }\n}, {\n    timestamps: true\n});\n\n// UserSchema.pre('save', function (next) {\n//     var user = this;\n//     if (this.isModified('password') || this.isNew) {\n//         bcrypt.genSalt(10, function (err, salt) {\n//             if (err) {\n//                 return next(err);\n//             }\n//             bcrypt.hash(user.password, salt, function (err, hash) {\n//                 if (err) {\n//                     return next(err);\n//                 }\n//                 user.password = hash;\n//                 next();\n//             });\n//         });\n//     } else {\n//         return next();\n//     }\n// });\n\n\nmodule.exports = mongoose.model('Message', MessageSchema);\n\n\n// WEBPACK FOOTER //\n// ./server/models/message.js","'use strict'\nvar Post = require('../models/post.js');\nclass PostController {\n    // read post\n    read(req, res) {\n            var id = req.params.id || '';\n            if (id == '') {\n                return res.sendStatus(400);\n            }\n            Post.find({\n                public: true\n            }, function(err, data) {\n                res.status(200).json({\n                    success: true,\n                    data: data,\n                });\n            });\n        }\n        // update post\n    update(req, res) {\n        // console.log(req.params);\n        let id = req.params.id || '';\n        if (id == '' || req.body.title == '' || req.body.content == '') {\n            return res.status(400).json({ success: false, msg: 'Server error try again!' });\n        }\n        let PostData = {};\n        PostData.title = req.body.title;\n        PostData.content = req.body.content;\n        if (req.body.public) {\n            PostData.public = req.body.public;\n        }\n        Post.update({ _id: id }, PostData, function(err, data) {\n            res.status(200).json({ success: true, msg: \"Post Updated!\" });\n        });\n    }\n\n    // Get post by slug\n    getPostBySlug(req, res) {\n            console.log(req.params);\n            // console.log(req.params.slug);\n            Post.findOne({\n                _id: req.params.id\n            }, (err, post) => {\n                // console.log(res);\n                res.json(post);\n            });\n            // query.select(publicFields);\n            // query.exec(function(err, result) {\n            //     if (err) {\n            //         console.log(err);\n            //         return res.sendStatus(400);\n            //     }\n\n            //     if (result != null) {\n            //         result.update({\n            //             $inc: {\n            //                 read: 1\n            //             }\n            //         }, function(err, nbRows, raw) {\n            //             // return res.json(200, result);\n            //             return result;\n            //         });\n            //     } else {\n            //         return res.sendStatus(400);\n            //     }\n            // });\n        }\n        // ----- Create post\n    create(req, res) {\n            // if (!req.user) {\n            // \treturn res.send(401);\n            // }\n            // console.log(req.body);\n\n            var post = req.body;\n            // console.log(req.body.title);\n            if (post == null || post.title == '' || post.editor == '') {\n                return res.sendStatus(400);\n            }\n\n            var postEntry = new Post();\n            postEntry.title = post.title;\n            console.log(post);\n            // postEntry.tags = post.tags.split(',');\n            // postEntry.is_published = post.is_published;\n            postEntry.content = post.content;\n\n            postEntry.save(function(err) {\n                if (err) {\n                    console.log(err);\n                    return res.sendStatus(400);\n                }\n\n                return res.sendStatus(200);\n            });\n        }\n        // -----LIST ALL POSTS\n    listAll(req, res) {\n        var query = Post.find();\n        query.sort('-created');\n        query.exec((err, results) => {\n            if (err) {\n                console.log(err);\n                return res.sendStatus(400);\n            }\n\n            for (var postKey in results) {\n                if (results[postKey].content != null) {\n                    results[postKey].content = results[postKey].content.substr(0, 400);\n                }\n            }\n\n            // local.posts = results;\n\n            return res.status(200).json(results);\n        });\n    }\n}\nmodule.exports = new PostController();\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/PostController.js","const mongoose = require('mongoose');\nconst bcrypt = require('bcrypt-nodejs');\nconst crypto = require('crypto');\n\n\n// set up a mongoose model\nconst userSchema = new mongoose.Schema({\n    // user_id: { type: Number, ref: 'User' },\n    name: {\n        type: String,\n        // required: true\n    },\n    password: {\n        type: String,\n        // required: true\n    },\n    email: {\n        type: String,\n        lowercase: true,\n        unique: true,\n        // required: true\n    },\n    role: {\n        type: String,\n        enum: ['Member', 'Client', 'Admin'],\n        default: 'Member'\n    },\n    google: {\n        id: String,\n        token: String,\n        // email: String,\n        // name: String\n    },\n    isActive: Boolean,\n    image: String\n}, {\n    timestamps: true\n});\n\nuserSchema.pre('save', function save(next) {\n    const user = this;\n    if (!user.isModified('password')) { return next(); }\n    bcrypt.genSalt(10, (err, salt) => {\n        if (err) { return next(err); }\n        bcrypt.hash(user.password, salt, null, (err, hash) => {\n            if (err) { return next(err); }\n            user.password = hash;\n            next();\n        });\n    });\n});\n\nuserSchema.methods.comparePassword = function comparePassword(candidatePassword, cb) {\n    bcrypt.compare(candidatePassword, this.password, (err, isMatch) => {\n        cb(err, isMatch);\n    });\n};\n\nmodule.exports = mongoose.model('User', userSchema);\n\n\n// WEBPACK FOOTER //\n// ./server/models/user.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 5\n// module chunks = 0","'use strict'\nconst User = require('../models/user');\n// const jwt       = require('jsonwebtoken');\nconst passport = require('passport');\nvar mongoose = require('mongoose');\n\n\nexports.create = function(req, res, next) {\n    req.assert('email', 'Email is not valid').isEmail();\n    req.assert('password', 'Password must be at least 4 characters long').len(4);\n    req.assert('password2', 'Passwords do not match').equals(req.body.password);\n    req.sanitize('email').normalizeEmail({ remove_dots: false });\n\n    const errors = req.validationErrors();\n\n    // console.log(req.flash().errors);\n\n    if (errors) {\n        // console.log(errors);\n        req.flash('errors', errors);\n        return res.json(errors);\n    }\n    // console.log(User);\n\n    const user = new User({\n        name: req.body.name,\n        email: req.body.email,\n        password: req.body.password\n    });\n    // console.log()\n\n    User.findOne({ email: req.body.email }, (err, existingUser) => {\n        // console.log(req.body);\n        if (err) { return next(err); }\n        if (existingUser) {\n            req.flash('errors', { msg: 'Account with that email address already exists.' });\n            return res.json([{ success: false, msg: 'Account with that email address already exists.' }]);\n        }\n        user.save((err) => {\n            // console.log('saving');\n            if (err) {\n                console.log(err);\n                // return next(err);\n            }\n            req.logIn(user, (err) => {\n                if (err) {\n                    return next(err);\n                }\n                // req.user = user;\n\n                res.json([{ success: true, msg: 'Success! Please Login!' }]);\n            });\n        });\n    });\n};\n\n// exports.read = function(req, res) {\n//   getToken = function (headers) {\n//     if (headers && headers.authorization) {\n//       var parted = headers.authorization.split(' ');\n//       if (parted.length === 2) {\n//         return parted[1];\n//       } else {\n//         return null;\n//       }\n//     } else {\n//       return null;\n//     }\n//   };\n//   console.log('dupa')\n//   var token = getToken(req.headers);\n//   // console.log(token);\n//\n//   passport.authenticate('local', (err, user, info) => {\n//\n//   });\n//   if (token) {\n//     var decoded = jwt.verify(token, config.secret);\n//     // console.log(decoded);\n//     UserModel.findOne({\n//       email: decoded.user.email\n//     }, function(err, user) {\n//         if (err) throw err;\n//\n//         if (!user) {\n//           return res.status(403).send({success: false, msg: 'Authentication failed. User not found.'});\n//         } else {\n//\n//           MessageModel.find({public: true}, function(err,data){\n//             res.json({success: true, user:user, data: data});\n//           });\n//         }\n//     });\n//   } else {\n//     return res.status(403).send({success: false, msg: 'No token provided.'});\n//   }\n// };\n\nexports.postLogin = function(req, res, next) {\n    // console.log(req.session);\n    req.assert('email', 'Email is not valid').isEmail();\n    req.assert('password', 'Password cannot be blank').notEmpty();\n    req.sanitize('email').normalizeEmail({ remove_dots: false });\n\n    const errors = req.validationErrors();\n\n    if (errors) {\n        req.flash('errors', errors);\n        return res.json({ success: false, msg: errors });\n    }\n\n    passport.authenticate('local', (err, user, info) => {\n        if (err) { return next(err); }\n        if (!user) {\n            req.flash('errors', info);\n            return res.json({ success: false, msg: 'Invalid password or email!' });\n        }\n        req.logIn(user, (err) => {\n            if (err) { return next(err); }\n            req.flash('success', { msg: 'Success! You are logged in.' });\n            res.json({\n                success: true,\n                msg: 'Success! You are logged in.',\n                user: user\n            });\n        });\n    })(req, res, next);\n}\n\nexports.auth = function(req, res) {\n    if (req.user) {\n        res.status(200).json(req.user);\n    } else {\n        res.sendStatus(403);\n    }\n}\nexports.authenticate = function(req, res, next) {\n    if (!req.isAuthenticated()) {\n        // res.status(403);\n        return res.status(403).render('403');\n    }\n    next();\n}\n\nexports.postLogout = function(req, res) {\n    req.logout();\n    req.session.authenticated = false;\n    res.json({ success: true, msg: 'Loged out!' })\n}\n\nexports.GetUsersList = function(req, res) {\n    User.find(function(err, data) {\n        res.json(data);\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/UserController.js","var mongoose = require('mongoose');\nvar Schema = mongoose.Schema;\n// var bcrypt = require('bcrypt');\nvar slugHero = require('mongoose-slug-hero');\n\n// Thanks to http://blog.matoski.com/articles/jwt-express-node-mongoose/\n\n// set up a mongoose model\nvar PostSchema = new Schema({\n  title: {\n    type: String\n  },\n  // image: {\n  //   type: Schema.Types.ObjectId,\n  //   ref: 'Image',\n  // },\n  content: {\n    type: String\n  },\n  createdBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  },\n  updatedBy: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  },\n  // comments: {\n  //   type: Schema.Types.ObjectId,\n  //   ref: 'Comment'\n  // },\n  // category: {\n  //   type: Schema.Types.ObjectId,\n  //   ref: 'Category'\n  // },\n  // tags: {\n  //   type: Schema.Types.ObjectId,\n  //   ref: 'Tag'\n  // },\n  public: {\n    type: Boolean,\n    default: true,\n  }\n}, {\n  timestamps: true\n});\n\nPostSchema.plugin(slugHero, { field: 'title' });\n\n\n\nmodule.exports = mongoose.model('Post', PostSchema);\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/post.js","module.exports = {\n    'secret': 'uihuihiuhuoiohoiutydrtyjiou78ut65edghhonu',\n    // 'database': 'mongodb://localhost:27017/pass-app'\n    // 'database': 'mongodb://mo14713_jarek:zaq1@WSX@mongo0.mydevil.net/mo14713_jarek'\n};\n\n\n// WEBPACK FOOTER //\n// ./server/config/database.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 9\n// module chunks = 0","const passport = require('passport');\nconst LocalStrategy = require('passport-local').Strategy;\nconst GoogleStrategy = require('passport-google-oauth').OAuth2Strategy;\n\n// load up the user model\nvar User = require('../models/user');\nvar config = require('./database'); // get db config file\n\nvar configAuth = require('./auth');\n\n// console.log(User);\n// module.exports = function(passport) {\n//   var opts = {};\n//   opts.secretOrKey = config.secret;\n//   passport.use(new JwtStrategy(opts, function(jwt_payload, done) {\n//     User.findOne({id: jwt_payload.id}, function(err, user) {\n//           if (err) {\n//               return done(err, false);\n//           }\n//           if (user) {\n//               done(null, user);\n//           } else {\n//               done(null, false);\n//           }\n//       });\n//   }));\n// };\n\n// module.exports = function(passport) {\npassport.serializeUser((user, done) => {\n    // console.log(user);\n    done(null, user.id);\n});\n\npassport.deserializeUser((id, done) => {\n    User.findById(id, (err, user) => {\n        done(err, user);\n    });\n});\n\npassport.use(new LocalStrategy({\n    usernameField: 'email',\n    session: true,\n    passReqToCallback: true,\n}, (req, email, password, done) => {\n    // console.log(email);\n\n    User.findOne({ email: email.toLowerCase() }, (err, user) => {\n        if (err) { return done(err); }\n        if (!user) {\n            return done(null, false, { msg: `Email ${email} not found.` });\n        }\n        if (!user.password) {\n            return done(null, false, { msg: 'Password not found, log in to your social account' })\n        }\n        user.comparePassword(password, (err, isMatch) => {\n            if (err) { return done(err); }\n            if (isMatch) {\n                req.session.authenticated = true;\n                return done(null, user);\n            }\n            return done(null, false, { msg: 'Invalid email or password.' });\n        });\n    });\n\n}));\n\npassport.use(new GoogleStrategy({\n\n        clientID: configAuth.googleAuth.clientID,\n        clientSecret: configAuth.googleAuth.clientSecret,\n        callbackURL: configAuth.googleAuth.callbackURL,\n\n    },\n    function(token, refreshToken, profile, done) {\n\n        // make the code asynchronous\n        // User.findOne won't fire until we have all our data back from Google\n        process.nextTick(function() {\n\n            // try to find the user based on their google id\n            User.findOne({ 'google.id': profile.id }, function(err, user) {\n                if (err)\n                    return done(err);\n\n                if (user) {\n\n                    // if a user is found, log them in\n                    return done(null, user);\n                } else {\n                    // if the user isnt in our database, create a new user\n                    var newUser = new User();\n\n                    // set all of the relevant information\n                    newUser.google.id = profile.id;\n                    newUser.google.token = token;\n                    // newUser.google.name = profile.displayName;\n                    newUser.name = profile.displayName;\n                    // newUser.google.email = profile.emails[0].value; // pull the first email\n                    newUser.email = profile.emails[0].value;\n\n                    // save the user\n                    newUser.save(function(err) {\n                        if (err) {\n                            throw err;\n                        }\n                        return done(null, newUser);\n                    });\n                }\n            });\n        });\n\n    }));\n\n\n// }\n\n\n\n\n/**\n * Login Required middleware.\n */\nexports.isAuthenticated = (req, res, next) => {\n    if (req.isAuthenticated()) {\n        return next();\n    }\n    res.json({ authentication: true });\n};\n\n// exports.auth = (req, res, next) => {\n//   // console.log(req.session);\n// };\n\n/**\n * Authorization Required middleware.\n */\nexports.isAuthorized = (req, res, next) => {\n    const provider = req.path.split('/').slice(-1)[0];\n    const token = req.user.tokens.find(token => token.kind === provider);\n    if (token) {\n        next();\n    } else {\n        res.json({ authentication: true });\n        // res.redirect(`/auth/${provider}`);\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./server/config/passport.js","'use strict'\nconst PostController = require('../controllers/PostController.js');\nconst express = require('express');\nconst MessageModel = require('../models/message');\nvar fs = require('fs');\nvar mongoose = require('mongoose');\n// var multiparty = require('connect-multiparty')();\n// Router\nconst controllers = {};\nvar Post = require('../models/post.js');\n\n\ncontrollers.user = require('../controllers/UserController.js');\nvar ChatController = require('../controllers/ChatController');\nconst UserController = require('../controllers/UserController.js');\n\n\n// PostController = new PostController();\n// console.log(PostController);\n\nconst API_AUTHENTICATION = controllers.user.authenticate;\n\n\nmodule.exports = (function() {\n    let admin = express.Router();\n    // admin.get('/checksession', (req, res, next) => {\n    //     // console.log(req.user);\n    //     res.json(req.user);\n    // });\n\n    admin.post('/signup', controllers.user.create);\n    admin.get('/auth', function(req, res) {\n        // console.log()\n        if (!req.isAuthenticated()) {\n            return res.sendStatus(401);\n        }\n        res.send(req.isAuthenticated() ? req.user : '0');\n    });\n\n    admin.post('/logout', controllers.user.postLogout);\n\n    admin.post('/login', controllers.user.postLogin);\n\n    admin.get('/listusers', API_AUTHENTICATION, controllers.user.GetUsersList);\n    // View messages to and from authenticated user\n    admin.get('/chat', API_AUTHENTICATION, ChatController.getConversations);\n\n    // Retrieve single conversation\n    admin.get('/chat/:conversationId', API_AUTHENTICATION, ChatController.getConversation);\n\n    // Send reply in conversation\n    admin.post('/chat/:conversationId', API_AUTHENTICATION, ChatController.sendReply);\n\n    // Start new conversation\n    admin.post('/chat/new/:recipient', API_AUTHENTICATION, ChatController.newConversation);\n\n    // passportConfig.isAuthenticated,\n\n    admin.get('/memberinfo', API_AUTHENTICATION, UserController.auth);\n\n    // admin.get('/chat', API_AUTHENTICATION, function(req, res) {\n    //     // console.log('ddd');\n    //     MessageModel.find({ public: true }, function(err, data) {\n    //         res.status(200).json({\n    //             success: true,\n    //             data: data,\n    //         });\n    //     });\n    // });\n\n\n    // Create Post\n    admin.post('/post', API_AUTHENTICATION, PostController.create);\n    admin.get('/post', API_AUTHENTICATION, PostController.listAll);\n    // Read post\n    admin.get('/post/:id', API_AUTHENTICATION, PostController.getPostBySlug);\n    admin.put('/post/:id', API_AUTHENTICATION, PostController.update);\n\n\n\n\n    // admin.post('/upload/:id', multiparty, function(req, res) {\n    //     var db = mongoose.connection.db;\n    //     var mongoDriver = mongoose.mongo;\n    //     var gfs = new Gridfs(db, mongoDriver);\n    //     var writestream = gfs.createWriteStream({\n    //         filename: req.files.file.name,\n    //         mode: 'w',\n    //         content_type: req.files.file.mimetype,\n    //         metadata: req.body\n    //     });\n    //     fs.createReadStream(req.files.file.path).pipe(writestream);\n    //     writestream.on('close', function(file) {\n    //         Post.findById(req.params.id, function(err, post) {\n    //             // handle error\n    //             post.file = file._id;\n    //             post.save(function(err, updatedPost) {\n    //                 // handle error\n    //                 return res.json(200, updatedPost)\n    //             })\n    //         });\n    //         fs.unlink(req.files.file.path, function(err) {\n    //             // handle error\n    //             console.log('success!')\n    //         });\n    //     });\n    // });\n\n    return admin;\n})();\n\n\n// WEBPACK FOOTER //\n// ./server/routes/admin.routes.js","'use strict'\nconst PostController = require('../controllers/PostController.js');\nconst express = require('express');\nconst MessageModel = require('../models/message');\n// Router\nconst controllers = {};\n\nconst passport = require('passport');\n\n\ncontrollers.user = require('../controllers/UserController.js');\n\n\n// PostController = new PostController();\n// console.log(PostController);\n\nconst API_AUTHENTICATION = controllers.user.authenticate;\n\nmodule.exports = (function() {\n    let auth = express.Router();\n\n    // =====================================\n    // GOOGLE ROUTES =======================\n    // =====================================\n    // send to google to do the authentication\n    // profile gets us their basic information including their name\n    // email gets their emails\n    auth.get('/auth/google', passport.authenticate('google', { scope: ['profile', 'email'] }));\n\n    // the callback after google has authenticated the user\n    auth.get('/auth/google/callback',\n        passport.authenticate('google', {\n            successRedirect: '/admin/dashboard',\n            failureRedirect: '/'\n        }));\n\n    return auth;\n})();\n\n\n// WEBPACK FOOTER //\n// ./server/routes/auth.routes.js","'use strict'\nconst PostController = require('../controllers/PostController.js');\nconst express = require('express');\nconst MessageModel = require('../models/message');\nvar Post = require('../models/post.js');\n// Router\nconst controllers = {};\n\n\n\ncontrollers.user = require('../controllers/UserController.js');\n\n\n// PostController = new PostController();\n// console.log(PostController);\n\nconst API_AUTHENTICATION = controllers.user.authenticate;\n\nmodule.exports = (function() {\n    let PublicRoute = express.Router();\n    //   public.get('/checksession', (req, res, next) => {\n    //     // console.log(req.user);\n    //     res.json(req.user);\n    //   });\n\n    PublicRoute.get('/', function(req, res) {\n        Post.find(function(err, data) {\n            res.render('pages/index', { posts: data })\n        });\n    });\n\n    PublicRoute.get('/photodiary', (req, res) => res.render('pages/photodiary'));\n    PublicRoute.get('/lifestyle', (req, res) => res.render('pages/lifestyle'));\n    PublicRoute.get('/music', (req, res) => res.render('pages/music'));\n    PublicRoute.get('/travel', (req, res) => res.render('pages/travel'));\n\n\n    // Read post\n    PublicRoute.get('/post/:slug', (req, res) => {\n        var query = Post.findOne({\n            slug: req.params.slug\n        });\n        // query.select(publicFields);\n        query.exec(function(err, result) {\n            if (err) {\n                console.log(err);\n                return res.sendStatus(400);\n            }\n\n            if (result != null) {\n                result.update({\n                    $inc: {\n                        read: 1\n                    }\n                }, function(err, nbRows, raw) {\n                    // console.log(result);\n                    // console.log(req);\n                    res.render('single/single', { post: result });\n                });\n            } else {\n                return res.sendStatus(400);\n            }\n        });\n\n\n    });\n    // Create Post\n\n    PublicRoute.get('/postListAll', API_AUTHENTICATION, PostController.listAll);\n\n    return PublicRoute;\n})();\n\n\n// WEBPACK FOOTER //\n// ./server/routes/public.routes.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"errorhandler\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"errorhandler\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"express-flash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-flash\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"express-validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-validator\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"https\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"https\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"method-override\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"method-override\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 26\n// module chunks = 0","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"node-uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-uuid\"\n// module id = 28\n// module chunks = 0","module.exports = require(\"nunjucks\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nunjucks\"\n// module id = 29\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"universal-analytics\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"universal-analytics\"\n// module id = 32\n// module chunks = 0","module.exports = {\n    'googleAuth': {\n        'clientID': '503533517399-fa0iva2h4ghr9s4slcmi6s98gjnl7aq6.apps.googleusercontent.com',\n        'clientSecret': 'Q6EftthvFpxRIbw8CymGkNHx',\n        'callbackURL': 'http://localhost:3000/auth/google/callback'\n            // 'callbackURL': 'https://app.jarekk1011.usermd.net/auth/google/callback'\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/config/auth.js","\"use strict\"\nconst Conversation = require('../models/conversation'),\n    Message = require('../models/message'),\n    User = require('../models/user');\n\nmodule.exports.getConversations = function(req, res, next) {\n    // console.log(req.user);\n    // Only return one message from each conversation to display as snippet\n    Conversation.find({ participants: req.user._id })\n        .select('_id')\n        .exec(function(err, conversations) {\n            if (err) {\n                res.send({ error: err });\n                return next(err);\n            }\n\n            // Set up empty array to hold conversations + most recent message\n            let fullConversations = [];\n            conversations.forEach(function(conversation) {\n                Message.find({ 'conversationId': conversation._id })\n                    .sort('-createdAt')\n                    .limit(1)\n                    .populate({\n                        path: \"author\",\n                        select: \"name\"\n                    })\n                    .exec(function(err, message) {\n                        if (err) {\n                            res.send({ error: err });\n                            return next(err);\n                        }\n                        fullConversations.push(message);\n                        if (fullConversations.length === conversations.length) {\n                            return res.status(200).json({ conversations: fullConversations });\n                        }\n                    });\n            });\n        });\n}\nmodule.exports.getConversation = function(req, res, next) {\n    Message.find({ conversationId: req.params.conversationId })\n        .select('createdAt body author')\n        .sort('-createdAt')\n        .populate({\n            path: 'author',\n            select: 'name'\n        })\n        .exec(function(err, messages) {\n            if (err) {\n                res.send({ error: err });\n                return next(err);\n            }\n\n            res.status(200).json({ conversation: messages });\n        });\n}\nmodule.exports.newConversation = function(req, res, next) {\n    if (!req.params.recipient) {\n        res.status(422).send({ error: 'Please choose a valid recipient for your message.' });\n        return next();\n    }\n\n    if (!req.body.composedMessage) {\n        res.status(422).send({ error: 'Please enter a message.' });\n        return next();\n    }\n\n    const conversation = new Conversation({\n        participants: [req.user._id, req.params.recipient]\n    });\n\n    conversation.save(function(err, newConversation) {\n        if (err) {\n            res.send({ error: err });\n            return next(err);\n        }\n\n        const message = new Message({\n            conversationId: newConversation._id,\n            body: req.body.composedMessage,\n            author: req.user._id\n        });\n\n        message.save(function(err, newMessage) {\n            if (err) {\n                res.send({ error: err });\n                return next(err);\n            }\n\n            res.status(200).json({ message: 'Conversation started!', conversationId: conversation._id });\n            return next();\n        });\n    });\n}\nmodule.exports.sendReply = function(req, res, next) {\n        const reply = new Message({\n            conversationId: req.params.conversationId,\n            body: req.body.composedMessage,\n            author: req.user._id\n        });\n\n        reply.save(function(err, sentReply) {\n            if (err) {\n                res.send({ error: err });\n                return next(err);\n            }\n\n            res.status(200).json({ message: 'Reply successfully sent!' });\n            return (next);\n        });\n    }\n    // DELETE Route to Delete Conversation\nmodule.exports.deleteConversation = function(req, res, next) {\n    Conversation.findOneAndRemove({\n        $and: [\n            { '_id': req.params.conversationId }, { 'participants': req.user._id }\n        ]\n    }, function(err) {\n        if (err) {\n            res.send({ error: err });\n            return next(err);\n        }\n\n        res.status(200).json({ message: 'Conversation removed!' });\n        return next();\n    });\n}\n\n// // PUT Route to Update Message\n// exports.updateMessage = function(req, res, next) {\n//     Conversation.find({\n//         $and: [\n//             { '_id': req.params.messageId }, { 'author': req.user._id }\n//         ]\n//     }, function(err, message) {\n//         if (err) {\n//             res.send({ error: err });\n//             return next(err);\n//         }\n\n//         message.body = req.body.composedMessage;\n\n//         message.save(function(err, updatedMessage) {\n//             if (err) {\n//                 res.send({ error: err });\n//                 return next(err);\n//             }\n\n//             res.status(200).json({ message: 'Message updated!' });\n//             return next();\n//         });\n//     });\n// }\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/ChatController.js","'use strict'\n// Dependencies\nconst session = require('express-session');\nconst bodyParser = require('body-parser');\nconst morgan = require('morgan');\nconst mongoose = require('mongoose');\nconst passport = require('passport');\nconst http = require('http');\nconst https = require('https');\nconst nunjucks = require('nunjucks');\nconst express = require('express');\nconst app = express();\nconst fs = require('fs');\n\nconst MongoStore = require('connect-mongo')(session);\nconst flash = require('express-flash');\nconst cookieParser = require('cookie-parser');\nconst dotenv = require('dotenv');\nconst expressValidator = require('express-validator');\nconst config = require('./config/database'); // get db config file\nconst PORT = process.env.PORT || 3000;\nconst methodOverride = require('method-override');\nconst cors = require('cors');\nconst path = require('path');\nconst errorHandler = require('errorhandler');\nconst PostController = require('./controllers/PostController.js');\nconst multer = require('multer');\n// var sslOptions = {\n//     key: fs.readFileSync(path.resolve('./server/localhost.key')),\n//     // cert: fs.readFileSync(path.resolve('./server/localhost.csr'))\n// };\nconst server = http.createServer(app);\nvar io = require('socket.io')(server);\n\n\n// google analitics\nconst ua = require('universal-analytics');\nconst visitor = ua('UA-97074565-1');\nvisitor.pageview(\"/\").send();\n\n\nconst root = process.cwd();\n\ndotenv.load({ path: '.env.config' });\n\n\n\n\nconst passportConfig = require('./config/passport');\n\n// console.log(passportConfig.isAuthenticated);\n// Models\nconst UserModel = require('./models/user'); // get the mongoose model\nconst MessageModel = require('./models/message');\n// const RoomsModel       = require('./server/models/rooms');\n\n\n// app.use('/uploads', express.static(root + '/uploads'));\nvar uuid = require('node-uuid');\n\n\nio.on('connection', function(client) {\n    io.sockets.emit('users-length', Object.keys(io.sockets.connected).length);\n    client.on('disconnect', function() {\n        io.sockets.emit('users-length', Object.keys(io.sockets.connected).length);\n    });\n\n    console.log('public socket connected');\n});\n//   client.on('join', (user) => {\n//         console.log(user);\n//         // people[client.id] = { \"name\": name, \"room\": roomID };\n//         // client.emit(\"update\", \"You have connected to the server.\");\n//         // socket.sockets.emit(\"update\", people[client.id].name + \" is online.\")\n//         // socket.sockets.emit(\"update-people\", people);\n//         // client.emit(\"roomList\", { rooms: rooms });\n//         // clients.push(client);\n\n//     });;\n\n\n//     client.on('message', function(data) {\n//         console.log(data);\n//     });\n\n\n\napp.use(function(req, res, next) {\n    res.locals.url = req.protocol + '://' + req.get('host');\n    next();\n});\n\napp.set('views', path.join(root, '/public/templates'));\n\nnunjucks.configure(app.get('views'), {\n    autoescape: true,\n    noCache: true,\n    watch: true,\n    express: app\n});\napp.set('view engine', 'nunjucks');\n\n// app.use(multer({ dest: root + '/dist/uploads/' }).any());\n// get our request parameters\napp.use(bodyParser.urlencoded({ extended: false }));\n\napp.use(express.static(root + '/dist'));\napp.use(bodyParser.json());\napp.set('trust proxy', 1);\napp.use(cors());\napp.use(cookieParser(process.env.SESSION_SECRET))\napp.use(session({\n    resave: true,\n    saveUninitialized: true,\n    secret: process.env.SESSION_SECRET,\n    store: new MongoStore({\n        mongooseConnection: mongoose.connection,\n        ttl: 24 * 24 * 60 * 60\n    }),\n    rolling: true,\n    cookie: {\n        httpOnly: true,\n        // secure: true,\n        ephemeral: true,\n        maxAge: 300000 //5min\n    }\n}));\napp.use(passport.initialize());\napp.use(passport.session());\napp.use(flash());\napp.use(expressValidator());\n// log to console\napp.use(morgan('dev'));\nmongoose.connect(process.env.MONGODB_URI || process.env.MONGOLAB_URI);\nmongoose.Promise = Promise;\n\nmongoose.connection.on('error', (err) => {\n    console.error(err);\n    console.log('%s MongoDB connection error. Please make sure MongoDB is running.', chalk.red('✗'));\n    process.exit();\n});\n\nmongoose.connection.on('connected', () => console.log('mongo connected'));\n\n\n// var count = 0;\n\n\n// locals\n// app.use('*', (req, res, next) => {\n//   res.locals.posts = PostController.listAllPublic;\n//   // console.log(PostController.listAllPublic);\n//   next();\n// });\n\n\n\n//----- ROUTES-------\n// app.all('/api/v1/*', [require('./middlewares/validateRequest')]);\napp.get('/admin*', (req, res, next) => res.sendFile(root + '/dist/admin.html'));\n// admin routes\napp.use('/api/admin', require('./routes/admin.routes'));\napp.use('/', require('./routes/auth.routes'));\n// public routes\napp.use('/', require('./routes/public.routes'));\n\n// 404\napp.get('*', (req, res) => res.status(404).render('404'));\n\n\n// console.log(io);\napp.use(errorHandler());\nserver.listen(PORT, () => console.log(`Listen on port: https://localhost:${PORT}`));\n\n\n// WEBPACK FOOTER //\n// ./server/main.js","const mongoose = require('mongoose'),\n    Schema = mongoose.Schema;\n\n// Schema defines how chat messages will be stored in MongoDB\nconst ConversationSchema = new Schema({\n    participants: [{ type: Schema.Types.ObjectId, ref: 'User' }],\n});\n\nmodule.exports = mongoose.model('Conversation', ConversationSchema);\n\n\n// WEBPACK FOOTER //\n// ./server/models/conversation.js","module.exports = require(\"bcrypt-nodejs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt-nodejs\"\n// module id = 37\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 38\n// module chunks = 0","module.exports = require(\"mongoose-slug-hero\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose-slug-hero\"\n// module id = 39\n// module chunks = 0","module.exports = require(\"passport-google-oauth\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-google-oauth\"\n// module id = 40\n// module chunks = 0","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 41\n// module chunks = 0"],"sourceRoot":""}